# AI-MATH 界面详细设计与功能说明

## 一、整体界面结构

界面从上到下包含以下主要部分：

1. **标题区**: 页面顶部中央显示大号居中的 **AI-MATH** 标题。
2. **题目块**: 显示当前数学题目。
3. **解答块区域**: 顺序显示所有解题步骤块。
4. **操作区**: 底部包含输入框及功能按钮。
5. **辅助内容区**: 显示类似题、AI提示、总结内容。

---

## 二、题目块详细设计

### 默认状态

* 显示渲染好的LaTeX数学题目。
* 右下角有两个按钮：

  * **Edit**（编辑）：进入LaTeX编辑模式。
  * **Upload**（上传）：进入图片上传模式。

### 编辑模式

点击 **Edit** 后：

* 出现LaTeX编辑框。
* 底部按钮变为三个：

  * **Cancel**（取消）：返回之前状态，不影响后续块。
  * **Confirm**（确认）：保存修改并渲染题目，清除后续所有解答块（仅修改后可用）。
  * **Upload**（上传）：切换到图片上传模式。

### 图片上传模式

* 调用豆包API识别图片为LaTeX。
* 转换结果可编辑。
* 点击确认后渲染为新题目。

---

## 三、解答块详细设计

每个解答块包含：

* **序号标识**：左侧数字编号。
* **正确性标记**：右上角显示 ✅（正确）或 ❌（错误）。
* **内容区域**：显示渲染后的LaTeX内容。
* **按钮区域**（右下角）：

  * **Edit**（编辑）
  * **Delete**（删除）
  * **Analyze**（解析）

### 3.1 解析功能

* 点击解析按钮后：

  * 检验该步骤正确性（右上角标记✅或❌）。
  * 显示解析区域：

    * 若正确：

      * 【概念】：使用的数学概念。
      * 【关键点】：步骤的关键细节。
      * 【推导细节】：详细解释。
    * 若错误：

      * 【概念】：使用的数学概念。
      * 【推导错误】：错误分析。
      * 【细节点】：可能忽视或出错的地方。
  * 解析按钮变为显示/隐藏解析的开关。

### 3.2 编辑功能

点击 **Edit** 后：

* 内容进入编辑状态。
* 按钮变为四个：

  * **Save**（保存）：保存修改并渲染。
  * **Split**（拆分）：拆分为两个步骤。
  * **Delete**（删除）：功能不变。
  * **Analyze**（解析）：功能不变。

### 3.3 拆分功能

* 点击 **Split** 后出现两个编辑区：Part 1 和 Part 2。
* 编辑区可调整内容（默认自动拆分推荐）。
* 下方有 **Confirm Split** 和 **Cancel** 两按钮。
* 确认拆分：生成两个新块，无正确性标记。
* 取消：恢复原状。

### 3.4 删除功能

* 点击删除按钮：删除当前块及其后的所有块。
* 删除≥5个块时，需二次确认。
* 删除操作可通过DAG追溯。

---

## 四、操作区详细设计

位于最下方，包括：

* 左侧小icon：**Similar**（类似题）。
* 中间输入框：输入下一步解题思路。
* 右侧四个按钮（顺序固定）：

  * **Submit/Solve All**（提交/全部解答）：

    * 有内容显示Submit，无内容显示Solve All。
    * 解答时按钮变为 **Stop**。
  * **AI Hint**（AI提示）：生成提示（解答中不可用）。
  * **Step Analyze**（步骤分析）：自动拆分并解析。
  * **Summary**（总结）：显示解题总结。

### 4.1 点击后效果

* **Similar**：加载后显示类似题，按钮变为关闭。
* **Summary**：加载后显示总结，按钮变为关闭。
* **AI Hint**：加载完成后恢复原状。
* **Submit/Solve All**：

  * 解答中显示 **Stop**，可中断解答过程并清除生成中块。
  * 解答完成或停止后按钮恢复。

---

## 五、输出内容区域

* **类似题**：位于操作区正下方。
* **AI提示**：类似题之下、总结之上。
* **总结**：位于最下方。

---

## 六、特殊功能

* **最终答案标记**：最终结果用方框包围居中：$\boxed{\text{答案}}$。
* **块拖动交互**：可拖至右侧打开交互对话框。
* **DAG追溯**：所有操作均可通过有向图回溯。

---

## 七、解析答案逻辑

每个解答块执行：

1. 检验之前所有块逻辑。
2. 根据完成状态判定是否继续。
3. 根据理解和历史形成下一步逻辑。
4. 完成一步后进行计算检验，最多重试3次。
5. 每步输出完成状态和新解答块。

---

## 八、初始上传题目界面设计

最初题目块：

* 位于标题下方，显示渲染好的默认题目。
* 底部右下角两个按钮：**Edit** 和 **Upload**。
* 点击 **Edit**：进入编辑模式，LaTeX框+三按钮（Cancel, Confirm, Upload）。
* 点击 **Upload**：调用图片识别API后显示LaTeX，进入编辑模式。

---

以上界面设计清晰、结构严谨、功能完整，确保产品易用且逻辑明确，满足迭代开发需求。










描述2
# AI-MATH 界面详细设计与功能规范

## 0. 整体界面结构

AI-MATH是一个数学解题辅助平台，界面从上到下分为以下几个主要部分：

1. **标题区**：页面顶部中央显示"AI-MATH"标题
2. **题目块**：显示当前数学题目
3. **解答块区域**：按顺序显示解题步骤
4. **操作区**：底部包含输入框和功能按钮
5. **辅助内容区**：根据需要显示类似题目、AI提示或总结内容
6. **DAG探索历史**：左侧可展开/收起的解题路径可视化区域


## 1. 页面整体布局

AI-MATH是一个数学解题辅助平台，页面从上到下、从左到右分为以下几个主要区域：

### 1.1 布局结构
- **标题区**：页面顶部中央显示"AI-MATH"标题/Logo
- **主体区**：分为左右两部分
  - **左侧DAG可视化区**：占据页面约30%宽度，可展开/收起
  - **右侧内容区**：占据页面约70%宽度，包含题目块和解答块区域
- **操作区**：页面底部包含输入框和功能按钮
- **辅助内容区**：操作区下方，显示类似题目、AI提示或总结等内容

### 1.2 响应式设计
- **PC端**（≥1280px）：三栏布局 
  - 左侧DAG可视化
  - 中间解题内容
  - 右侧可能出现的对话区（解答块拖动后）
- **平板端**：单栏主内容，DAG收为侧边栏
- **移动端**：折叠DAG和辅助区，按钮纵向排列

## 2. 题目块 (Problem Block)

### 2.1 结构
- **标识**：左侧带有"题目"标签
- **内容区**：显示渲染好的LaTeX数学题目
- **按钮区**：右下角有两个按钮：
  - `编辑` (Edit✏️)：用于使用LaTeX编辑题目
  - `上传` (Upload📷)：用于通过图片上传题目

### 2.2 默认状态
- 显示LaTeX渲染后的数学题目
- 右下角显示编辑和上传按钮

### 2.3 编辑模式
- **触发**：点击"编辑"按钮
- **显示**：
  - LaTeX代码编辑框，显示当前题目的LaTeX代码
  - 底部三个按钮：
    - `取消` (Cancel↩️)：返回默认状态，不保存更改
    - `确认` (Confirm✔️)：保存修改并渲染，同时清除所有解答块（仅当内容有修改时可点击）
    - `上传` (Upload📷)：切换到图片上传模式

### 2.4 图片上传模式
- **触发**：点击"上传"按钮或编辑模式下的"上传"按钮
- **流程**：
  1. 选择/上传图片
  2. 调用API（"豆包"）进行OCR识别，转换为LaTeX
  3. 转换结果显示在编辑框中，允许手动修改
  4. 点击"确认"后，渲染为题目并清除之前的解答块

## 3. 解答块 (Solution Block)

### 3.1 结构
- **序号标识**：左侧显示圆形编号（1, 2, 3...）
- **正确性标记**：右上角显示✅（正确）或❌（错误）（解析后出现）
- **内容区域**：显示渲染后的LaTeX数学内容
- **按钮区域**：右下角三个按钮
  - `编辑` (Edit✏️)
  - `删除` (Delete🗑️)
  - `解析` (Explain🔍)

### 3.2 解析功能
- **触发**：点击"解析"按钮
- **操作流程**：
  1. 系统检验该步骤是否正确
  2. 右上角显示✅（正确）或❌（错误）
  3. 展开解析面板，包含三部分：
     - 【概念】：使用的数学概念（可能没有）
     - 【关键点】：该步骤的关键点
     - 正确时显示【推导细节】，错误时显示【推导错误】
  4. 解析按钮变为折叠/展开图标，可切换解析区域的显示状态
- **注意**：如果对该步骤进行了编辑，正确与否的判定（✅/❌）消失，需要重新点击解析按钮

### 3.3 编辑功能
- **触发**：点击"编辑"按钮
- **状态变化**：
  - 内容变为可编辑的LaTeX代码
  - 按钮区域变为四个按钮：
    - `保存` (Save💾)：保存编辑内容并渲染
    - `拆分` (Split✂️)：将步骤拆分为两部分
    - `删除` (Delete🗑️)：功能不变
    - `解析` (Explain🔍)：功能不变
  - 保存后，按钮恢复为三个（编辑、删除、解析）

### 3.4 拆分功能
- **触发**：编辑模式下点击"拆分"按钮
- **操作界面**：
  - 显示两个编辑区域："第1部分"和"第2部分"
  - 系统自动在合适位置拆分原LaTeX内容
  - 底部显示"确认拆分"和"取消"按钮
- **操作流程**：
  - 用户可编辑两部分内容
  - 点击"确认拆分"生成两个新的解答块（没有✅/❌标记）
  - 点击"取消"返回原编辑状态

### 3.5 删除功能
- **触发**：点击"删除"按钮
- **操作**：
  - 删除当前块及其后的所有块
  - 当删除≥5个块时，弹出确认对话框
  - 所有删除操作可在DAG中追溯

## 4. 操作区 (Controls Bar)

### 4.1 组件布局
操作区位于主内容区底部，组件排列为：
```
[类似题📚] [文本输入框（较宽）] [提交/全部解答🖊] [AI提示💡] [步骤分析🔬] [总结📝]
```

### 4.2 文本输入框
- 用于输入下一步解答思路
- 占据操作区大部分宽度，明显大于其他按钮
- 输入文本后触发"提交"功能

### 4.3 功能按钮

#### 4.3.1 第一阶段（无解答块时）
按钮排列及功能：
1. **类似题按钮** (Similar📚)：最左侧小图标按钮
2. **提交/全部解答按钮** (Submit/Auto🖊)：
   - 有输入内容时显示"提交"
   - 无输入内容时显示"全部解答"
3. **AI提示按钮** (AI Hint💡)
4. **答案解析按钮** (Step Chk🔬)
5. **总结按钮** (Summary📝)

#### 4.3.2 第二阶段（出现解答块后）
功能按钮调整：
1. **提交/全部解答按钮**：逻辑不变，但不包含选择思路下拉列表
2. **AI提示按钮**：功能不变
3. **步骤分析按钮**：功能与答案解析类似，专注于当前步骤
4. **总结按钮**：功能不变

### 4.4 按钮功能详解

#### 4.4.1 类似题按钮 (Similar📚)
- **功能**：调用RAG技术检索相关题目
- **操作流程**：
  - 点击后显示"加载中"状态
  - 加载完成后显示类似题目
  - 按钮变为"关闭类似题"
  - 再次点击关闭类似题目显示

#### 4.4.2 提交/全部解答按钮 (Submit/Auto🖊)
- **根据输入框状态变化**：
  - 输入框有内容：显示"提交"
  - 输入框无内容：显示"全部解答"
- **提交功能**：
  - 根据输入内容生成一个新解答块
  - 点击后按钮变为"停止解答"
  - 完成或停止后恢复"提交"状态
- **全部解答功能**：
  - 自动连续生成解答块直到完成
  - 点击后按钮变为"停止解答"
  - 可随时停止生成过程

#### 4.4.3 AI提示按钮 (AI Hint💡)
- **功能**：提供下一步解题提示
- **操作流程**：
  - 点击后显示"加载中"
  - 加载完成后显示提示内容
  - 提示内容出现在辅助内容区
- **使用限制**：生成解答过程中（显示"停止解答"时）不可用

#### 4.4.4 步骤分析/答案解析按钮 (Step Chk🔬)
- **功能**：
  - 将步骤拆分为子步骤
  - 对每个子步骤自动进行解析
  - 确认每个子步骤是否正确
- **操作流程**：
  - 点击后按钮变为"处理中"
  - 分析完成后生成多个解答块
  - 每个新块自动调用解析功能

#### 4.4.5 总结按钮 (Summary📝)
- **功能**：整合题目、解题过程和DAG历史生成总结
- **操作流程**：
  - 点击后显示"加载中"
  - 加载完成后按钮变为"关闭总结"
  - 总结内容显示在辅助内容区最下方

## 5. 输出内容区域

### 5.1 内容排列
- **解答块**：位于题目块下方，按解题步骤顺序排列
- **辅助内容**：位于操作区下方，固定顺序为：
  1. 类似题内容（最上方）
  2. AI提示内容（中间）
  3. 总结内容（最下方）

### 5.2 内容交互
- 每个辅助内容区块可独立折叠/展开
- 辅助内容区不影响主解题区的滚动

## 6. DAG探索历史可视化

### 6.1 整体布局
- **位置**：页面左侧
- **宽度**：默认占据页面约30%宽度
- **高度**：与主内容区等高，可独立滚动

### 6.2 视图控制
- **顶部控制栏**：包含展开/收起、缩放等控制按钮
- **默认状态**：占据左侧30%宽度
- **展开状态**：向右扩展至70-80%宽度，主内容区收缩
- **收起状态**：最小化为窄条，增大主工作区面积

### 6.3 节点设计
- **形状**：圆角矩形设计，大小适中便于显示内容
- **特殊节点**：
  - 起始节点（题目）：特殊颜色或标记
  - 终止节点（完成解答）：星形标记或特殊边框
- **状态表示**：
  - 正确步骤：绿色边框/背景
  - 错误步骤：红色边框/背景
  - 未验证步骤：灰色或中性色
  - 当前活动节点：蓝色高亮或加粗边框

### 6.4 节点交互
- **悬停**：显示步骤简要预览，提供展开选项
- **左键点击**：加载该节点对应的完整解题路径
- **右键菜单**：提供附加选项
  - 添加备注信息
  - 思路解读
  - 标记高亮（可选择颜色）
  - 从此处开始新路径

### 6.5 边的设计
- **连接方式**：有向箭头连接相关节点
- **样式区分**：
  - 当前主解题路径：粗线表示
  - 成功解题路径：绿色线条（带柔和光晕）
  - 其他探索路径：细线条

## 7. 解析答案逻辑

解析过程遵循以下流程：

1. **接收块内容**：获取当前解答步骤
2. **校验历史逻辑**：检验之前所有块的推导是否合理
3. **完成判定**：根据是否完成题目信息进行判定
   - 如果已完成，标记✅并停止分析
   - 如果未完成，继续后续步骤
4. **生成思路**：基于理解和前序步骤形成下一步思路
5. **形成解答**：从完整逻辑链中截取适当步骤生成解答
6. **计算检验**：进行数学计算验证步骤正确性
   - 正确：块右上角标记✅
   - 不正确：尝试重新生成，连续三次错误则标记❌并停止
7. **完成信号**：生成是否完成题目的信号
8. **输出与存储**：生成新解题块并存储相关信息

## 8. 特殊功能与交互

### 8.1 最终答案标记
- 最终答案使用`\boxed{}`包围
- 居中显示，视觉上明确标识解题完成

### 8.2 Drag → Chat功能
- 解答块可拖拽到右侧区域
- 触发与专门训练的大模型对话
- 便于针对特定步骤进行交互式答疑

### 8.3 DAG追溯
- 所有操作实时写入DAG节点/边
- 支持历史操作回溯
- 允许多路径探索和比较

### 8.4 块间交互
- 支持块的拖拽调整顺序
- 允许块的合并与拆分
- 提供丰富的编辑和管理操作

## 9. 界面风格与设计规范

### 9.1 命名规范
- 所有UI资源命名采用kebab-case（如"solution-block"）
- 图标统一来自Heroicons v2库

### 9.2 响应式设计
- 针对不同设备优化布局
- 移动端按钮纵向排列，使用统一的40×40 IconButton

### 9.3 首屏体验
- 默认展示Demo题目
- 提供清晰的入门引导
- 引导用户进行第一步操作

### 9.4 交互反馈
- 所有操作提供明确的视觉反馈
- 加载过程显示适当的加载指示
- 错误处理有明确的用户提示

这个设计方案旨在提供一个直观、易用的数学解题环境，通过DAG可视化帮助用户理解不同解题思路，结合AI辅助实现高效的数学学习和探索体验。界面设计符合现代web应用标准，同时考虑了不同设备的使用场景和响应式需求。